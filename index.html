<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <title>Campus Hub</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="stylesheet" href="css/menu.css">
    <link rel="stylesheet" href="css/intro.css">
    <link rel="stylesheet" href="css/responsive.css">

    <style>
        /* Prevent any touch zooming */
        * {
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }

        /* Prevent text size adjustment */
        html {
            -webkit-text-size-adjust: 100%;
            text-size-adjust: 100%;
        }

        /* Ensure proper touch targets */
        button,
        [role="button"],
        a {
            touch-action: manipulation;
            user-select: none;
            -webkit-user-select: none;
        }
    </style>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js" defer>
    </script>

    <!-- Puter.js for AI functionality -->
    <script src="https://js.puter.com/v2/"></script>

    <style>
        /* === GLOBAL STYLES & VARIABLES === */
        :root {
            --color-primary: #0066ff;
            --color-secondary: #00f2c3;
            --color-text: #333;
            --color-text-light: #555;
            --color-bg: #ffffff;
            --color-bg-light: #f7f9fc;
            --font-family: 'Plus+Jakarta+Sans', sans-serif;
            --shadow-light: 0 4px 12px rgba(0, 0, 0, 0.05);
            --shadow-medium: 0 6px 16px rgba(0, 0, 0, 0.08);
            --color-food: #ffb703;
            --color-school: #023e8a;
            --color-other: #adb5bd;
            --navbar-height: 70px;
            --mobile-breakpoint: 768px;
        }

        /* Prevent content shift and ensure proper spacing */
        body {
            padding: 0;
            margin: 0;
            -webkit-text-size-adjust: 100%;
            touch-action: manipulation;
        }

        /* Ensure pages start below navbar */
        .page {
            padding-top: calc(var(--navbar-height) + 20px);
            min-height: calc(100vh - var(--navbar-height));
        }

        /* Basic Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family);
            color: var(--color-text);
            background-color: var(--color-bg);
            line-height: 1.6;
            touch-action: manipulation;
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
        }

        /* Dark mode theme overrides */
        body.dark-mode {
            --color-bg: #0b1120;
            --color-bg-light: #111827;
            --color-text: #e5e7eb;
            --color-text-light: #9ca3af;
            --shadow-light: 0 4px 12px rgba(0, 0, 0, 0.6);
            --shadow-medium: 0 6px 16px rgba(0, 0, 0, 0.8);
            background-color: var(--color-bg);
            color: var(--color-text);
        }

        body.dark-mode .form-container,
        body.dark-mode .workspace-widget,
        body.dark-mode .event-card,
        body.dark-mode .market-card,
        body.dark-mode .job-card {
            background-color: #020617;
            border-color: #1f2937;
        }

        body.dark-mode .page-header,
        body.dark-mode .stats,
        body.dark-mode .features,
        body.dark-mode .how-it-works,
        body.dark-mode .market-list,
        body.dark-mode .job-list,
        body.dark-mode .workspace-grid {
            background-color: var(--color-bg-light);
        }

        body.dark-mode .navbar,
        body.dark-mode .chat-window {
            background-color: #020617;
            color: var(--color-text);
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 20px;
        }

        main {
            animation: fadeIn 0.5s ease-out;
        }

        /* Utility class for section titles */
        .section-title {
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 10px;
            animation: fadeIn 1s ease-out;
        }

        .section-subtitle {
            font-size: 1.1rem;
            color: var(--color-text-light);
            text-align: center;
            margin-bottom: 40px;
            animation: fadeIn 1.2s ease-out;
        }

        /* === ANIMATIONS === */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* === SECTION 1: NAVIGATION BAR === */
        /* Navigation styles moved to menu.css */
        .nav-button-login {
            color: var(--color-primary);
        }

        /* === HOMEPAGE: SECTION 2 (HERO) === */
        .hero {
            padding: 60px 20px;
            text-align: center;
        }

        .hero h1 {
            font-size: 2.5rem;
            font-weight: 800;
            line-height: 1.2;
            margin-bottom: 15px;
            animation: fadeIn 0.8s ease-out;
        }

        .hero h1 span {
            background: linear-gradient(90deg, var(--color-primary), var(--color-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            color: transparent;
        }

        .hero p {
            font-size: 1.1rem;
            color: var(--color-text-light);
            max-width: 600px;
            margin: 0 auto 30px;
            animation: fadeIn 1.0s ease-out;
        }

        .hero-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
            animation: fadeIn 1.2s ease-out;
        }

        /* Button Styles */
        .btn {
            display: inline-block;
            padding: 14px 28px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            width: 100%;
            max-width: 300px;
            cursor: pointer;
        }

        .btn-primary {
            background-color: var(--color-primary);
            color: #fff;
        }

        .btn-primary:hover {
            background-color: #0055dd;
        }

        .btn-secondary {
            background-color: #fff;
            color: var(--color-primary);
            border-color: var(--color-primary);
        }

        .btn-secondary:hover {
            background-color: #f0f6ff;
        }

        .btn-light {
            background-color: #fff;
            color: var(--color-primary);
            font-weight: 700;
        }

        .btn-light:hover {
            transform: scale(1.05);
        }

        /* === HOMEPAGE: SECTION 3 (STATS) === */
        .stats {
            padding: 40px 20px;
            background-color: var(--color-bg-light);
        }

        .stats-container {
            display: flex;
            justify-content: space-around;
            text-align: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .stat-item {
            animation: fadeIn 1.4s ease-out;
        }

        .stat-item h3 {
            font-size: 2rem;
            font-weight: 700;
            color: var(--color-primary);
        }

        .stat-item p {
            font-size: 1rem;
            color: var(--color-text-light);
        }

        /* === HOMEPAGE: SECTION 4 (FEATURES) === */
        .features {
            padding: 60px 20px;
            background-color: var(--color-bg);
        }

        .features-grid {
            display: grid;
            gap: 20px;
        }

        .feature-card {
            background-color: var(--color-bg-light);
            border: 1px solid #eee;
            border-radius: 12px;
            padding: 25px;
            display: flex;
            align-items: center;
            gap: 20px;
            animation: fadeIn 1.2s ease-out;
        }

        .feature-card-icon {
            font-size: 1.5rem;
            background-color: #e6f0ff;
            color: var(--color-primary);
            padding: 12px;
            border-radius: 8px;
        }

        .feature-card h3 {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .feature-card p {
            font-size: 0.95rem;
            color: var(--color-text-light);
        }

        /* === HOMEPAGE: SECTION 5 (HOW IT WORKS) === */
        .how-it-works {
            padding: 60px 20px;
            background-color: var(--color-bg-light);
        }

        .how-steps {
            display: flex;
            flex-direction: column;
            gap: 30px;
            max-width: 500px;
            margin: 0 auto;
        }

        .how-step {
            text-align: center;
            animation: fadeIn 1.2s ease-out;
        }

        .how-step-number {
            display: inline-block;
            width: 40px;
            height: 40px;
            line-height: 40px;
            border-radius: 50%;
            background-color: #e6f0ff;
            color: var(--color-primary);
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 15px;
        }

        .how-step h3 {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .how-step p {
            font-size: 1rem;
            color: var(--color-text-light);
        }

        /* === HOMEPAGE: SECTION 6 (FINAL CTA) === */
        .cta {
            padding: 60px 20px;
            text-align: center;
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);
            color: #fff;
            margin: 20px;
            border-radius: 20px;
            animation: fadeIn 1.5s ease-out;
        }

        .cta h2 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 15px;
        }

        .cta p {
            font-size: 1.1rem;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        /* === GENERIC PAGE STYLES (Events, Market, Jobs) === */
        .page {
            display: none;
        }

        /* Hide all pages by default */
        .page-header {
            padding: 40px 20px 30px;
            background-color: var(--color-bg-light);
            border-bottom: 1px solid #eee;
        }

        .page-header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 5px;
        }

        .page-header p {
            font-size: 1.1rem;
            color: var(--color-text-light);
            margin-bottom: 25px;
        }

        .page-header-actions {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .btn-action {
            background-color: var(--color-primary);
            color: #fff;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            max-width: 300px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .btn-action:hover {
            background-color: #0055dd;
        }

        .btn-action span {
            font-size: 1.2rem;
            line-height: 1;
        }

        /* Admin-only sections and elements */
        [data-admin-only] {
            display: none !important;
        }

        body.is-admin [data-admin-only] {
            display: block !important;
        }

        body.is-admin [data-admin-only].btn-action,
        body.is-admin [data-admin-only].btn,
        body.is-admin li[data-admin-only] {
            display: inline-block !important;
        }

        body.is-admin li[data-admin-only] {
            display: list-item !important;
        }

        .events-list {
            padding: 30px 20px;
            background-color: var(--color-bg);
        }

        .event-card-list {
            display: grid;
            gap: 20px;
        }

        .event-card {
            background-color: #fff;
            border: 1px solid #eee;
            border-radius: 12px;
            box-shadow: var(--shadow-light);
            padding: 25px;
            animation: fadeIn 0.8s ease-out;
        }

        .event-card h3 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .event-card-subtitle {
            font-size: 1rem;
            color: var(--color-text-light);
            margin-bottom: 20px;
        }

        .event-card-details {
            list-style: none;
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .event-card-details li {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
            color: var(--color-text);
        }

        .event-card-details li span {
            display: inline-block;
            width: 20px;
            text-align: center;
        }

        .event-card-footer {
            font-size: 0.9rem;
            color: var(--color-text-light);
            border-top: 1px solid #f0f0f0;
            padding-top: 15px;
        }

        .event-card-footer a {
            color: var(--color-primary);
            text-decoration: none;
            font-weight: 600;
        }

        /* === GENERIC FORM PAGE STYLES (Login, Profile, Post) === */
        .form-page {
            padding: 40px 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: var(--color-bg-light);
            min-height: 80vh;
        }

        .form-container {
            background-color: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: var(--shadow-medium);
            width: 100%;
            max-width: 450px;
            animation: fadeIn 0.5s ease-out;
        }

        .form-container h2 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-align: center;
        }

        .form-container p {
            font-size: 1rem;
            color: var(--color-text-light);
            margin-bottom: 30px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            font-family: var(--font-family);
            background-color: #fff;
            /* for select */
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--color-primary);
        }

        .btn-submit {
            width: 100%;
            padding: 14px;
            font-size: 1rem;
            max-width: none;
        }

        /* === LOGIN PAGE TAB STYLES === */
        .login-tab-nav {
            display: flex;
            border-bottom: 1px solid #eee;
            margin-bottom: 25px;
        }

        .login-tab {
            flex: 1;
            padding: 12px 10px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            font-family: var(--font-family);
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--color-text-light);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .login-tab:hover {
            color: var(--color-text);
        }

        .login-tab.active {
            color: var(--color-primary);
            border-bottom-color: var(--color-primary);
        }

        .login-tab-panel {
            display: none;
            /* Hide all panels */
        }

        .login-tab-panel.active {
            display: block;
            /* Show active panel */
        }

        .login-toggle {
            margin-top: 20px;
            font-size: 0.9rem;
            text-align: center;
        }

        .login-toggle-link {
            color: var(--color-primary);
            font-weight: 600;
            cursor: pointer;
        }

        .signup-field {
            display: none;
        }

        /* === MARKETPLACE PAGE STYLES === */
        .market-list {
            padding: 30px 20px;
        }

        .market-grid {
            display: grid;
            gap: 20px;
        }

        .market-card {
            background-color: #fff;
            border: 1px solid #eee;
            border-radius: 12px;
            box-shadow: var(--shadow-light);
            overflow: hidden;
            animation: fadeIn 0.8s ease-out;
        }

        .market-card-image {
            width: 100%;
            height: 180px;
            background-color: #eee;
            background-size: cover;
            background-position: center;
            color: #aaa;
            display: flex;
            align-items: center;
            justify-content: center;
            font-style: italic;
        }

        .market-card-content {
            padding: 20px;
        }

        .market-card h3 {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .market-card-desc {
            font-size: 1rem;
            color: var(--color-text-light);
            margin-bottom: 10px;
        }

        .market-card-price {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 15px;
        }

        .btn-bid {
            width: 100%;
            max-width: none;
            background-color: var(--color-secondary);
            color: #333;
            font-weight: 700;
            border-color: var(--color-secondary);
        }

        .btn-bid:hover {
            background-color: #00d4a8;
            border-color: #00d4a8;
        }

        /* === JOB BOARD STYLES === */
        .filter-bar {
            padding: 20px 20px 0;
            background-color: var(--color-bg);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }

        .filter-group label {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }

        .filter-group input,
        .filter-group select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            font-family: var(--font-family);
            background-color: #fff;
        }

        .job-list {
            padding: 30px 20px;
        }

        .job-grid {
            display: grid;
            gap: 20px;
        }

        .job-card {
            background-color: #fff;
            border: 1px solid #eee;
            border-radius: 12px;
            box-shadow: var(--shadow-light);
            padding: 25px;
            transition: all 0.3s ease;
        }

        .job-card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .job-card-icon {
            font-size: 1.8rem;
            background-color: #f0f6ff;
            color: var(--color-primary);
            padding: 15px;
            border-radius: 8px;
            line-height: 1;
        }

        .job-card h3 {
            font-size: 1.3rem;
            font-weight: 700;
        }

        .job-card-company {
            font-size: 1rem;
            color: var(--color-text-light);
        }

        .job-card-details {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }

        .job-card-tag {
            background-color: #eee;
            color: var(--color-text-light);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .job-card-skills {
            font-size: 0.95rem;
            color: var(--color-text);
        }

        .job-card-skills strong {
            color: var(--color-text);
        }

        /* === PERSONAL WORKSPACE STYLES === */
        .workspace-grid {
            padding: 30px 20px;
            display: grid;
            gap: 30px;
            max-width: 100%;
            overflow-x: hidden;
        }

        .workspace-widget {
            background-color: #fff;
            border: 1px solid #eee;
            border-radius: 12px;
            box-shadow: var(--shadow-light);
        }

        .workspace-widget-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
        }

        .workspace-widget-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .workspace-widget-body {
            padding: 20px;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
            overflow-x: hidden;
        }

        .workspace-widget input,
        .workspace-widget select,
        .workspace-widget button {
            width: 100%;
            box-sizing: border-box;
            margin: 0;
        }

        @media (min-width: 768px) {
            #budget-add-form {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* To-Do List Styles */
        #todo-input-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        #todo-input {
            flex-grow: 1;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            font-family: var(--font-family);
        }

        #todo-add-btn {
            background: var(--color-primary);
            color: white;
            border: none;
            padding: 0 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        #todo-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        #todo-list li {
            background: var(--color-bg-light);
            padding: 15px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1rem;
        }

        #todo-list li .todo-remove-btn {
            background: #ff4136;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 8px;
            cursor: pointer;
            font-weight: bold;
        }

        /* Embedded Chat Styles */
        .embedded-chat-log {
            height: 300px;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 15px;
        }

        .embedded-chat-input-area {
            display: flex;
            border-top: 1px solid #eee;
            padding-top: 15px;
        }

        #workspace-chat-input {
            flex-grow: 1;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 12px 15px;
            font-size: 1rem;
            font-family: var(--font-family);
        }

        #workspace-chat-send-btn {
            background: var(--color-primary);
            color: white;
            border: none;
            padding: 0 20px;
            border-radius: 8px;
            margin-left: 10px;
            cursor: pointer;
            font-weight: 600;
        }

        /* Budget Tracker Styles */
        #budget-add-form {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-bottom: 20px;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }

        #budget-desc {
            grid-column: 1 / -1;
            /* Span full width */
        }

        #budget-add-btn {
            grid-column: 1 / -1;
            background: var(--color-primary);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
        }

        #budget-total {
            font-size: 1.8rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 20px;
        }

        #budget-list {
            list-style: none;
            margin-bottom: 20px;
            max-height: 200px;
            overflow-y: auto;
        }

        .expense-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .expense-item span:first-child {
            font-weight: 600;
        }

        .expense-item span:last-child {
            font-weight: 700;
        }

        /* Budget Visualization */
        #budget-viz {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .viz-bar-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .viz-bar-container {
            width: 100%;
            background-color: #eee;
            border-radius: 5px;
            height: 20px;
            overflow: hidden;
        }

        .viz-bar {
            height: 100%;
            width: 0%;
            /* Set by JS */
            transition: width 0.5s ease-out;
            text-align: right;
            color: white;
            font-size: 0.8rem;
            line-height: 20px;
            padding-right: 5px;
        }

        .viz-bar.food {
            background-color: var(--color-food);
        }

        .viz-bar.school {
            background-color: var(--color-school);
        }

        .viz-bar.other {
            background-color: var(--color-other);
        }

        /* ========================================
        === NEW: DAILY CHALLENGE STYLES === 
        ========================================
        */
        .challenge-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        #challenge-topic-select {
            flex-grow: 1;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            font-family: var(--font-family);
            background-color: #fff;
        }

        #new-challenge-btn {
            background: var(--color-primary);
            color: white;
            border: none;
            padding: 0 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        #challenge-problem-area {
            background-color: var(--color-bg-light);
            padding: 20px;
            border-radius: 8px;
            min-height: 100px;
            font-size: 1rem;
            line-height: 1.6;
        }

        /* === VOICE ASSISTANT (MIC) BUTTON === */
        .floating-btn {
            position: fixed;
            width: 60px;
            height: 60px;
            border: none;
            border-radius: 50%;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow-medium);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .floating-btn:hover {
            transform: scale(1.1);
        }

        .voice-assistant-btn {
            bottom: 30px;
            right: 30px;
            background-color: var(--color-primary);
            color: white;
        }

        .voice-assistant-btn.is-listening {
            background-color: #ff4136;
            /* Red */
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(255, 65, 54, 0.7);
            }

            70% {
                box-shadow: 0 0 0 15px rgba(255, 65, 54, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(255, 65, 54, 0);
            }
        }

        /* === CHATBOT STYLES === */
        .chat-btn {
            bottom: 110px;
            right: 30px;
            background-color: var(--color-secondary);
            color: #333;
            font-size: 28px;
        }

        /* === TELEGRAM BOT BUTTON === */
        .telegram-btn {
            bottom: 190px;
            right: 30px;
            background-color: #0088cc;
            /* Telegram blue */
            color: #fff;
            font-size: 24px;
        }

        .telegram-btn svg {
            width: 28px;
            height: 28px;
            fill: currentColor;
        }

        .chat-window {
            display: none;
            /* Hidden by default */
            position: fixed;
            bottom: 110px;
            right: 30px;
            width: 350px;
            height: 450px;
            background: #fff;
            border-radius: 12px;
            box-shadow: var(--shadow-medium);
            z-index: 1001;
            overflow: hidden;
            flex-direction: column;
            animation: fadeIn 0.3s ease-out;
        }

        .chat-window.is-open {
            display: flex;
        }

        .chat-header {
            background: var(--color-primary);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-header h3 {
            font-size: 1.2rem;
        }

        .chat-close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
        }

        .chat-log {
            flex-grow: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .chat-message {
            padding: 10px 15px;
            border-radius: 18px;
            max-width: 80%;
            line-height: 1.4;
        }

        .chat-message.user {
            background-color: #eee;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }

        .chat-message.bot {
            background-color: var(--color-primary);
            color: white;
            align-self: flex-start;
            border-bottom-left-radius: 4px;
        }

        .chat-input-area {
            display: flex;
            border-top: 1px solid #eee;
        }

        #chat-input {
            flex-grow: 1;
            border: none;
            padding: 15px;
            font-size: 1rem;
            font-family: var(--font-family);
        }

        #chat-input:focus {
            outline: none;
        }

        #chat-send-btn {
            background: var(--color-primary);
            color: white;
            border: none;
            padding: 0 20px;
            font-size: 1.2rem;
            cursor: pointer;
        }

        /* === DESKTOP STYLES (min-width: 768px) === */
        @media (min-width: 768px) {

            /* --- Navbar --- */
            .navbar-platform-tag {
                display: block;
            }

            .navbar-toggle {
                display: none;
            }

            .navbar-menu {
                display: block;
                position: static;
                width: auto;
                background: none;
                border-bottom: none;
            }

            .navbar-menu ul {
                flex-direction: row;
                gap: 20px;
            }

            .navbar-menu li {
                padding: 0;
                border: none;
            }

            .nav-button-login {
                background: #f0f6ff;
                color: var(--color-primary);
                padding: 8px 16px;
                border-radius: 20px;
            }

            .nav-button-login:hover {
                background: #e0e9ff;
            }

            /* --- Hero --- */
            .hero h1 {
                font-size: 3.5rem;
            }

            .hero p {
                font-size: 1.2rem;
            }

            .hero-buttons {
                flex-direction: row;
                justify-content: center;
            }

            .btn {
                width: auto;
            }

            /* --- Stats --- */
            .stats-container {
                flex-wrap: nowrap;
            }

            .stat-item h3 {
                font-size: 2.5rem;
            }

            /* --- Features --- */
            .features-grid {
                grid-template-columns: 1fr 1fr;
            }

            /* --- How It Works --- */
            .how-steps {
                flex-direction: row;
                max-width: none;
                justify-content: space-around;
            }

            .how-step {
                width: 30%;
            }

            /* --- CTA --- */
            .cta {
                padding: 80px 20px;
            }

            .cta h2 {
                font-size: 2.8rem;
            }

            /* --- Events Page --- */
            .page-header-actions {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }

            .btn-action {
                width: auto;
                max-width: none;
            }

            .event-card-list {
                grid-template-columns: 1fr 1fr;
            }

            /* --- Form Pages --- */
            .form-container {
                padding: 40px;
            }

            /* --- Marketplace --- */
            .market-grid {
                grid-template-columns: repeat(3, 1fr);
                /* 3-column grid */
            }

            /* --- Job Board --- */
            .filter-bar {
                flex-direction: row;
                /* Horizontal filters on desktop */
                gap: 20px;
            }

            .job-grid {
                grid-template-columns: 1fr 1fr;
                /* 2-column grid */
            }

            /* --- Workspace --- */
            .workspace-grid {
                grid-template-columns: 1fr 1fr;
                /* 2-column grid */
            }

            /* Make AI assistant and Budget span full width if needed */
            .workspace-widget.ai-assistant,
            .workspace-widget.budget {
                grid-column: 1 / -1;
                /* Span full width */
            }
        }
    </style>
</head>

<body>

    <style>
        /* Accessibility improvements */
        .skip-link {
            position: absolute;
            top: -9999px;
            left: 50%;
            transform: translateX(-50%);
            background: #000;
            color: #fff;
            padding: 1rem;
            z-index: 10000;
            text-decoration: none;
            border-radius: 0 0 0.5rem 0.5rem;
        }

        .skip-link:focus {
            top: 0;
        }

        /* Enhanced keyboard focus styles */
        a:focus-visible,
        button:focus-visible,
        input:focus-visible,
        select:focus-visible,
        textarea:focus-visible {
            outline: 3px solid #007fd4;
            outline-offset: 2px;
        }

        [role="button"]:focus-visible {
            outline: 3px solid #007fd4;
            outline-offset: 2px;
        }
    </style>

    <a class="skip-link" href="#main-content" aria-label="Skip to main content">Skip to content</a>

    <!-- Intro animation video -->
    <div id="site-intro-overlay" class="intro-overlay" aria-hidden="false" role="region" aria-label="Welcome animation">
        <div class="intro-content">
            <video id="intro-video" class="intro-video" muted autoplay playsinline preload="auto"
                aria-label="Campus Hub welcome animation">
                <source src="assets/intro.mp4" type="video/mp4">
                <source src="assets/intro-fallback.webm" type="video/webm">
                <img src="assets/logo.jpg" alt="Fallback image" style="width: 100%; height: 100%; object-fit: contain;">
            </video>
        </div>
    </div>

    <style>
        /* Responsive intro video styles */
        .intro-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 1;
            transition: opacity 0.5s ease-out;
        }

        .intro-overlay.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        .intro-content {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .intro-video {
            width: 100%;
            height: 100%;
            object-fit: contain;
            position: absolute;
            top: 0;
            left: 0;
        }

        /* Responsive breakpoints for intro video */
        @media (max-width: 480px) {
            .intro-video {
                max-height: 100vh;
            }
        }

        @media (min-width: 481px) and (max-width: 1024px) {
            .intro-video {
                max-height: 100vh;
                max-width: 100%;
            }
        }

        @media (min-width: 1025px) {
            .intro-video {
                max-width: 90%;
                max-height: 90vh;
                margin: auto;
            }
        }

        /* High DPI screens */
        @media (-webkit-min-device-pixel-ratio: 2),
        (min-resolution: 192dpi) {
            .intro-video {
                image-rendering: -webkit-optimize-contrast;
            }
        }
    </style>

    <header class="navbar" id="main-navbar" role="banner">
        <div class="navbar-container">
            <div class="navbar-branding">
                <a class="navbar-logo" id="logo-home-link" href="#" aria-label="Campus Hub home">
                    <img src="assets/logo.jpg" alt="Campus Hub" class="site-logo" />
                    <span class="site-title">Campus Hub</span>
                </a>
                <div class="navbar-platform-tag">‚ú® Platform for College Students</div>
            </div>

            <button class="navbar-toggle" id="mobile-menu-toggle" aria-label="Toggle menu" aria-expanded="false">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </button>

            <nav class="navbar-menu" id="navbar-menu" role="navigation" aria-label="Main navigation">
                <div class="menu-container">
                    <ul>
                        <li><a id="nav-workspace-link" href="#page-workspace">Workspace</a></li>
                        <li><a id="nav-explore-link" href="#page-events">Explore</a></li>
                        <li><a id="nav-jobs-link" href="#page-jobs">Jobs</a></li>
                        <li><a id="nav-market-link" href="#page-market">Marketplace</a></li>
                        <li><a id="nav-profile-link" href="#page-profile">Profile</a></li>
                        <li><a id="nav-feedback-link" href="#page-feedback">Feedback</a></li>
                        <li data-admin-only><a id="nav-admin-dashboard-link"
                                href="#page-admin-dashboard">Admin</a></li>
                        <li><button id="btn-theme-toggle"
                                style="border:none;background:#f3f4f6;border-radius:999px;padding:6px 12px;cursor:pointer;font-size:0.9rem;">üåô</button>
                        </li>
                        <li data-logged-out><a class="nav-button-login" id="nav-login-link" role="button"
                                aria-label="Open login dialog" tabindex="0">Login</a></li>
                        <li data-logged-in style="display:none;"><a class="nav-button-login" id="nav-logout-link"
                                role="button" aria-label="Logout" tabindex="0">Logout</a></li>
                    </ul>
                </div>
            </nav>
        </div>
    </header>

    <!-- Load environment variables (generated at build time) -->
    <script src="js/env.js"></script>

    <!-- Supabase configuration and service -->
    <script src="js/supabase-config.js" defer></script>

    <!-- App integration with Supabase -->
    <script src="js/app-integration.js" defer></script>

    <!-- Non-critical scripts are lazy-loaded via js/loader.js -->
    <script src="js/loader.js" defer></script>
    <div id="page-home" class="page" style="display: block;">
        <section class="hero">
            <div class="container">
                <h1>Your Campus Hub for <span>Events, Jobs & Rewards</span></h1>
                <p id="home-user-summary" class="hero-user-summary" data-requires-auth></p>
                <p>
                    Find the best building events, find views on campus gigs,
                    find all the student discounts, and play the card rewards by contributing to the
                    community.
                </p>
                <div class="hero-buttons">
                    <a href="#" class="btn btn-primary" id="btn-explore-gigs">Explore Gigs</a>
                    <a href="#" class="btn btn-secondary" id="btn-start-earning">Start Earning Rewards</a>
                </div>
            </div>
        </section>

        <section class="stats">
            <div class="container stats-container">
                <div class="stat-item">
                    <h3>500+</h3>
                    <p>Campus</p>
                </div>
                <div class="stat-item">
                    <h3>1000+</h3>
                    <p>Gigs</p>
                </div>
                <div class="stat-item">
                    <h3>250K+</h3>
                    <p>Students</p>
                </div>
            </div>
        </section>

        <section class="features">
            <div class="container">
                <h2 class="section-title">Everything You Need</h2>
                <p class="section-subtitle">One platform for all your various opportunities</p>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-card-icon">üè´</div>
                        <div>
                            <h3>College Events</h3>
                            <p>Access exclusive events & networking opportunities.</p>
                        </div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-card-icon">üíª</div>
                        <div>
                            <h3>Remote Jobs</h3>
                            <p>Find flexible remote jobs that fit your student schedule.</p>
                        </div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-card-icon">üí∏</div>
                        <div>
                            <h3>Student Discounts</h3>
                            <p>Save money with exclusive discounts.</p>
                        </div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-card-icon">üèÜ</div>
                        <div>
                            <h3>Earn Rewards</h3>
                            <p>Get flat discounts, earn cash, and win rewards.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="how-it-works">
            <div class="container">
                <h2 class="section-title">How It Works</h2>
                <p class="section-subtitle">Simple steps to start exploring rewards</p>
                <div class="how-steps">
                    <div class="how-step">
                        <div class="how-step-number">1</div>
                        <h3>Browse or Guest Mode</h3>
                        <p>Access events, jobs, and deals as a guest.</p>
                    </div>
                    <div class="how-step">
                        <div class="how-step-number">2</div>
                        <h3>Contribute Content</h3>
                        <p>Share a post or help your peers and be rewarded.</p>
                    </div>
                    <div class="how-step">
                        <div class="how-step-number">3</div>
                        <h3>Earn Rewards</h3>
                        <p>Get discounts on brands or earn money.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="cta">
            <div class="container">
                <h2>Ready to Get Started?</h2>
                <p>Join thousands of students already exploring their campus</p>
                <a href="#" class="btn btn-light" id="btn-join-now">Join Now - It's Free!</a>
            </div>
        </section>
    </div>
    <div id="page-events" class="page">

        <section class="page-header">
            <div class="container page-header-actions">
                <div>
                    <h1>Campus Events</h1>
                    <p>Skill-building events by colleges</p>
                </div>
                <button class="btn-action" id="btn-post-event"><span>+</span> Post Event</button>
            </div>
        </section>
        <section class="events-list">
            <div class="container event-card-list">
                <!-- Filled dynamically from Supabase by app-integration.js (loadEvents) -->
            </div>
        </section>
    </div>
    <div id="page-login" class="page">
        <section class="form-page">
            <div class="form-container">

                <div class="login-tab-nav">
                    <button id="btn-tab-user" class="login-tab active">User</button>
                    <button id="btn-tab-admin" class="login-tab">Admin</button>
                </div>

                <div id="user-login-panel" class="login-tab-panel active">
                    <h2 id="login-title">Login</h2>
                    <p id="login-subtitle">Welcome back! Access your account.</p>
                    <form id="login-form">
                        <div class="form-group signup-field" id="signup-name-field">
                            <label for="name">Full Name</label>
                            <input type="text" id="name" name="name">
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="password">Password</label>
                            <input type="password" id="password" name="password" required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-submit" id="login-submit-btn">Login</button>
                    </form>
                    <div class="login-toggle">
                        <span id="login-toggle-text">Don't have an account?</span>
                        <a class="login-toggle-link" id="login-toggle-link">Sign Up</a>
                    </div>
                </div>

                <div id="admin-login-panel" class="login-tab-panel">
                    <h2>Admin Login</h2>
                    <p>Access the admin dashboard.</p>
                    <form id="admin-login-form">
                        <div class="form-group">
                            <label for="admin-email">Email</label>
                            <input type="email" id="admin-email" name="admin-email" required>
                        </div>
                        <div class="form-group">
                            <label for="admin-password">Password</label>
                            <input type="password" id="admin-password" name="admin-password" required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-submit">Admin Login</button>
                    </form>
                </div>

            </div>
        </section>
    </div>
    <div id="page-profile" class="page">
        <section class="form-page">
            <div class="form-container">
                <h2>Profile Settings</h2>
                <p>Update your name and payment details.</p>
                <form id="profile-form">
                    <div class="form-group">
                        <label for="profile-name">Full Name</label>
                        <input type="text" id="profile-name" placeholder="John Doe">
                    </div>
                    <div class="form-group">
                        <label for="profile-phone">Phone Number (for PhonePe)</label>
                        <input type="tel" id="profile-phone" placeholder="e.g., 9123456789">
                    </div>
                    <button type="submit" class="btn btn-primary btn-submit" id="btn-save-profile">Save
                        Settings</button>
                    <button type="button" class="btn btn-secondary btn-submit" id="btn-profile-logout"
                        style="margin-top:10px;">Logout</button>
                </form>
            </div>
        </section>
    </div>
    <div id="page-post-event" class="page">
        <section class="form-page">
            <div class="form-container">
                <h2>Post a New Event</h2>
                <p>Fill in the details to post your event.</p>
                <form id="post-event-form">
                    <div class="form-group">
                        <label for="event-title">Event Title</label>
                        <input type="text" id="event-title" required>
                    </div>
                    <div class="form-group">
                        <label for="event-desc">Event Description</label>
                        <textarea id="event-desc" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="event-organizer">Organizer</label>
                        <input type="text" id="event-organizer" required>
                    </div>
                    <div class="form-group">
                        <label for="event-date">Date</label>
                        <input type="date" id="event-date" required>
                    </div>
                    <div class="form-group">
                        <label for="event-location">Location</label>
                        <input type="text" id="event-location" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-submit" id="btn-submit-event">Submit Event & Win
                        Reward</button>
                </form>
            </div>
        </section>
    </div>
    <div id="page-market" class="page">
        <section class="page-header">
            <div class="container page-header-actions">
                <div>
                    <h1>Marketplace</h1>
                    <p>Buy & sell second-hand items</p>
                </div>
                <button class="btn-action" id="btn-sell-item"><span>+</span> Sell an Item</button>
            </div>
        </section>

        <section class="market-list">
            <div class="container">
                <div class="section-header-flex">
                    <div class="market-grid" id="market-grid-container">
                    </div>
                    <div class="market-grid" id="market-items-grid">
                        <!-- Filled dynamically from Supabase by app-integration.js (loadMarketItems) -->
                    </div>
                </div>
        </section>
    </div>
    <div id="page-sell-item" class="page">
        <section class="form-page">
            <div class="form-container">
                <h2>Sell Your Item</h2>
                <p>Create a listing for the marketplace.</p>
                <form id="sell-item-form">
                    <div class="form-group">
                        <label for="item-title">Item Name</label>
                        <input type="text" id="item-title" required>
                    </div>
                    <div class="form-group">
                        <label for="item-desc">Short Description</label>
                        <input type="text" id="item-desc" required>
                    </div>
                    <div class="form-group">
                        <label for="item-price">Starting Bid (‚Çπ)</label>
                        <input type="number" id="item-price" required>
                    </div>
                    <div class="form-group">
                        <label for="item-password">Item Room Password</label>
                        <input type="text" id="item-password" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-submit" id="btn-submit-item">Post Item to
                        Marketplace</button>
                </form>
            </div>
        </section>
    </div>
    <div id="page-jobs" class="page">
        <section class="page-header">
            <div class="container page-header-actions">
                <div>
                    <h1>Jobs & Internships</h1>
                    <p>Find your next campus opportunity.</p>
                </div>
                <button class="btn-action" id="btn-post-job"><span>+</span> Post Job</button>
            </div>
        </section>

        <section class="filter-bar container">
            <div class="filter-group">
                <label for="filter-skill">Filter by Skill (e.g., Python, Marketing)</label>
                <input type="text" id="filter-skill" placeholder="Type a skill...">
            </div>
            <div class="filter-group">
                <label for="filter-job-type">Filter by Job Type</label>
                <select id="filter-job-type">
                    <option value="all">All Job Types</option>
                    <option value="internship">Internship</option>
                    <option value="part-time">Part-time</option>
                    <option value="full-time">Full-time</option>
                </select>
            </div>
        </section>

        <section class="job-list">
            <div class="container">
                <div class="job-grid" id="job-grid-container">

                    <div class="job-card" data-type="internship" data-skills="javascript,react,css,web">
                        <div class="job-card-header">
                            <div class="job-card-icon">üíª</div>
                            <div>
                                <h3>Frontend Developer Intern</h3>
                                <p class="job-card-company">Tech Solutions Inc.</p>
                            </div>
                        </div>
                        <div class="job-card-details">
                            <span class="job-card-tag">Internship</span>
                            <span class="job-card-tag">Remote</span>
                        </div>
                        <p class="job-card-skills">
                            <strong>Skills:</strong> JavaScript, React, CSS
                        </p>
                    </div>

                    <div class="job-card" data-type="part-time" data-skills="marketing,social media,content">
                        <div class="job-card-header">
                            <div class="job-card-icon">üìà</div>
                            <div>
                                <h3>Social Media Manager</h3>
                                <p class="job-card-company">Campus Eats</p>
                            </div>
                        </div>
                        <div class="job-card-details">
                            <span class="job-card-tag">Part-time</span>
                            <span class="job-card-tag">On-Campus</span>
                        </div>
                        <p class="job-card-skills">
                            <strong>Skills:</strong> Marketing, Social Media, Content Creation
                        </p>
                    </div>

                    <div class="job-card" data-type="internship" data-skills="python,django,sql,backend">
                        <div class="job-card-header">
                            <div class="job-card-icon">üêç</div>
                            <div>
                                <h3>Backend Python Intern</h3>
                                <p class="job-card-company">DataCorp</p>
                            </div>
                        </div>
                        <div class="job-card-details">
                            <span class="job-card-tag">Internship</span>
                            <span class="job-card-tag">Remote</span>
                        </div>
                        <p class="job-card-skills">
                            <strong>Skills:</strong> Python, Django, SQL
                        </p>
                    </div>

                </div>
            </div>
        </section>
    </div>
    <div id="page-post-job" class="page">
        <section class="form-page">
            <div class="form-container">
                <h2>Post a New Job</h2>
                <p>Fill in the details for the job or internship.</p>
                <form id="post-job-form">
                    <div class="form-group">
                        <label for="job-title">Job Title</label>
                        <input type="text" id="job-title" required>
                    </div>
                    <div class="form-group">
                        <label for="job-company">Company Name</label>
                        <input type="text" id="job-company" required>
                    </div>
                    <div class="form-group">
                        <label for="job-type">Job Type</label>
                        <select id="job-type" required>
                            <option value="" disabled selected>Select a type...</option>
                            <option value="internship">Internship</option>
                            <option value="part-time">Part-time</option>
                            <option value="full-time">Full-time</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="job-location">Location</label>
                        <input type="text" id="job-location" placeholder="e.g., Remote, On-Campus" required>
                    </div>
                    <div class="form-group">
                        <label for="job-skills">Required Skills (comma-separated)</label>
                        <input type="text" id="job-skills" placeholder="e.g., Python, JavaScript, Marketing" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-submit" id="btn-submit-job">Post Job</button>
                </form>
            </div>
        </section>
    </div>
    <div id="page-feedback" class="page">
        <section class="form-page">
            <div class="form-container">
                <h2>Send Us Feedback</h2>
                <p>Let us know what you think or report a bug.</p>
                <form id="feedback-form">
                    <div class="form-group">
                        <label for="feedback-name">Your Name</label>
                        <input type="text" id="feedback-name" name="from_name" required>
                    </div>
                    <div class="form-group">
                        <label for="feedback-email">Your Email</label>
                        <input type="email" id="feedback-email" name="reply_to" required>
                    </div>
                    <div class="form-group">
                        <label for="feedback-message">Message</label>
                        <textarea id="feedback-message" name="message" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary btn-submit" id="btn-send-feedback">Send
                        Feedback</button>
                </form>
            </div>
        </section>
    </div>
    <div id="page-workspace" class="page">
        <section class="page-header">
            <div class="container">
                <h1>Personal Workspace</h1>
                <p>Your private space for tasks and quick help.</p>
            </div>
        </section>

        <section class="workspace-grid container">

            <div class="workspace-widget">
                <div class="workspace-widget-header">
                    <h2>My To-Do List</h2>
                </div>
                <div class="workspace-widget-body">
                    <form id="todo-input-form">
                        <input type="text" id="todo-input" placeholder="Add a new task..." required>
                        <button type="submit" id="todo-add-btn">Add</button>
                    </form>
                    <ul id="todo-list">
                    </ul>
                </div>
            </div>

            <div class="workspace-widget">
                <div class="workspace-widget-header">
                    <h2>Daily Challenge</h2>
                </div>
                <div class="workspace-widget-body">
                    <div class="challenge-controls">
                        <select id="challenge-topic-select">
                            <option value="tech">Tech</option>
                            <option value="marketing">Marketing</option>
                            <option value="general">General</option>
                        </select>
                        <button id="new-challenge-btn">New Problem</button>
                    </div>
                    <div id="challenge-problem-area">
                        Click "New Problem" to get started!
                    </div>
                </div>
            </div>

            <div class="workspace-widget" id="workspace-saved-widget">
                <div class="workspace-widget-header">
                    <h2>My Saved</h2>
                </div>
                <div class="workspace-widget-body">
                    <p style="font-size:0.9rem;color:#555;">Quick access to your saved events, jobs, and marketplace
                        items.</p>
                    <div id="saved-events-section" style="margin-top:10px;">
                        <h3 style="font-size:1rem;margin-bottom:6px;">Events</h3>
                        <ul id="saved-events-list" style="list-style:none;padding-left:0;font-size:0.9rem;"></ul>
                    </div>
                    <div id="saved-jobs-section" style="margin-top:14px;">
                        <h3 style="font-size:1rem;margin-bottom:6px;">Jobs</h3>
                        <ul id="saved-jobs-list" style="list-style:none;padding-left:0;font-size:0.9rem;"></ul>
                    </div>
                    <div id="saved-market-section" style="margin-top:14px;">
                        <h3 style="font-size:1rem;margin-bottom:6px;">Marketplace</h3>
                        <ul id="saved-market-list" style="list-style:none;padding-left:0;font-size:0.9rem;"></ul>
                    </div>
                </div>
            </div>

            <div class="workspace-widget" id="workspace-events-calendar-widget">
                <div class="workspace-widget-header"
                    style="display:flex;justify-content:space-between;align-items:center;gap:10px;">
                    <h2>Events Calendar</h2>
                    <button id="calendar-reminder-bell" title="View today's reminders"
                        style="border:none;background:#eef2ff;border-radius:999px;padding:6px 10px;cursor:pointer;font-size:1rem;">üîî</button>
                </div>
                <div class="workspace-widget-body">
                    <div id="events-calendar-header"
                        style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                        <button id="events-calendar-prev"
                            style="border:none;background:#eee;border-radius:6px;padding:4px 8px;cursor:pointer;">‚óÄ</button>
                        <h3 id="events-calendar-title" style="margin:0;font-size:1.1rem;"></h3>
                        <button id="events-calendar-next"
                            style="border:none;background:#eee;border-radius:6px;padding:4px 8px;cursor:pointer;">‚ñ∂</button>
                    </div>
                    <table id="events-calendar" style="width:100%;border-collapse:collapse;font-size:0.9rem;">
                        <thead>
                            <tr>
                                <th>Sun</th>
                                <th>Mon</th>
                                <th>Tue</th>
                                <th>Wed</th>
                                <th>Thu</th>
                                <th>Fri</th>
                                <th>Sat</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Filled by JS -->
                        </tbody>
                    </table>
                    <div id="events-calendar-list" style="margin-top:12px;font-size:0.9rem;">
                        <strong>Events on selected day:</strong>
                        <ul id="events-calendar-items" style="list-style:none;padding-left:0;margin-top:8px;"></ul>
                    </div>
                    <div id="events-calendar-reminder" style="margin-top:12px;font-size:0.9rem;">
                        <strong>Personal reminder for this day:</strong>
                        <div id="calendar-selected-date-label" style="margin:4px 0;color:#555;"></div>
                        <input type="text" id="calendar-reminder-input" placeholder="Add a note for this day..."
                            style="width:100%;padding:8px 10px;border:1px solid #ddd;border-radius:6px;font-size:0.9rem;margin-bottom:6px;">
                        <button id="calendar-reminder-save"
                            style="width:100%;border:none;border-radius:6px;padding:8px 10px;background:#4f46e5;color:#fff;cursor:pointer;font-size:0.9rem;font-weight:600;">Save
                            Reminder</button>
                        <div id="calendar-reminder-current" style="margin-top:6px;color:#4b5563;"></div>
                    </div>
                </div>
            </div>

            <div class="workspace-widget budget">
                <div class="workspace-widget-header">
                    <h2>My Budget Tracker</h2>
                </div>
                <div class="workspace-widget-body">
                    <h3 id="budget-total">Total: ‚Çπ0.00</h3>

                    <div id="budget-viz">
                        <div class="viz-bar-label">
                            <span>Food</span><span id="food-percent">0%</span>
                        </div>
                        <div class="viz-bar-container">
                            <div class="viz-bar food" id="food-bar"></div>
                        </div>
                        <div class="viz-bar-label">
                            <span>School</span><span id="school-percent">0%</span>
                        </div>
                        <div class="viz-bar-container">
                            <div class="viz-bar school" id="school-bar"></div>
                        </div>
                        <div class="viz-bar-label">
                            <span>Other</span><span id="other-percent">0%</span>
                        </div>
                        <div class="viz-bar-container">
                            <div class="viz-bar other" id="other-bar"></div>
                        </div>
                    </div>

                    <hr style="margin: 20px 0;">

                    <form id="budget-add-form">
                        <input type="text" id="budget-desc" placeholder="Expense Description" required>
                        <input type="number" id="budget-amount" placeholder="Amount (‚Çπ)" required>
                        <select id="budget-category" required>
                            <option value="food">Food</option>
                            <option value="school">School</option>
                            <option value="other">Other</option>
                        </select>
                        <button type="submit" id="budget-add-btn">Add Expense</button>
                    </form>

                    <ul id="budget-list">
                    </ul>
                </div>
            </div>

            <div class="workspace-widget ai-assistant" id="workspace-ai-widget" style="display: none;">
                <div class="workspace-widget-header">
                    <h2>Personal Assistant</h2>
                </div>
                <div class="workspace-widget-body">
                    <div class="embedded-chat-log" id="workspace-chat-log">
                        <div class="chat-message bot">
                            Hello! Ask me for a 'roadmap' (e.g., 'roadmap for web developer') or to 'explain' a concept
                            (e.g., 'explain python').
                        </div>
                    </div>
                    <div class="embedded-chat-input-area">
                        <input type="text" id="workspace-chat-input" placeholder="Ask me something...">
                        <button id="workspace-chat-send-btn">Send</button>
                    </div>
                </div>
            </div>

        </section>
    </div>
    <div id="page-admin-dashboard" class="page" data-admin-only>
        <section class="page-header">
            <div class="container">
                <h1>Admin Dashboard</h1>
                <p>Manage all events, jobs, and marketplace items.</p>
                <div id="admin-dashboard-summary"
                    style="margin-top:15px;display:flex;flex-wrap:wrap;gap:10px;font-size:0.95rem;">
                    <span style="background:#eef2ff;border-radius:999px;padding:6px 12px;">Events live: <strong
                            id="admin-count-events">0</strong></span>
                    <span style="background:#ecfeff;border-radius:999px;padding:6px 12px;">Jobs live: <strong
                            id="admin-count-jobs">0</strong></span>
                    <span style="background:#fef3c7;border-radius:999px;padding:6px 12px;">Items live: <strong
                            id="admin-count-items">0</strong></span>
                </div>
                <div style="margin-top:15px;max-width:320px;">
                    <canvas id="admin-overview-chart" width="320" height="220"
                        style="width:100%;max-width:320px;background:#fff;border-radius:12px;border:1px solid #e5e7eb;"></canvas>
                </div>
            </div>
        </section>
        <section class="container" style="padding:30px 20px;">
            <div class="form-container" style="max-width:1000px;margin:0 auto;">
                <div id="admin-events-list" style="margin-bottom:30px;font-size:0.95rem;"></div>

                <div id="admin-jobs-list" style="margin-bottom:30px;font-size:0.95rem;"></div>

                <div id="admin-market-list" style="font-size:0.95rem;"></div>
            </div>
        </section>
    </div>
    </main>
    <footer class="site-footer">
        <div class="container">
            &copy; <span id="footer-year"></span> Campus Hub. All rights reserved. Built with ‚ù§ for students.
        </div>
    </footer>

    <!-- Floating Buttons (Voice Assistant & Chatbot & Telegram) -->
    <button class="floating-btn voice-assistant-btn" id="voice-assist-btn" aria-label="Voice Assistant">üé§</button>
    <button class="floating-btn chat-btn" id="chat-toggle-btn" aria-label="Open Chatbot">üí¨</button>
    <button class="floating-btn telegram-btn" id="telegram-bot-btn" aria-label="Open Telegram Bot">
        <svg viewBox="0 0 24 24" role="img" aria-hidden="true">
            <path
                d="M21.543 2.47a1.5 1.5 0 0 0-1.53-.182L3.064 9.685a1.5 1.5 0 0 0 .118 2.818l3.71 1.247 1.438 4.791a1.5 1.5 0 0 0 2.48.643l2.39-2.286 3.71 2.787a1.5 1.5 0 0 0 2.367-.86l2.737-14.03a1.5 1.5 0 0 0-.472-1.325ZM9.79 15.966l-.96-3.197 6.744-4.04-5.784 4.905ZM18.63 6.2l-2.266 11.615-3.588-2.698a1.5 1.5 0 0 0-2.05.106l-1.105 1.058-.83-2.763 8.915-7.318Z" />
        </svg>
    </button>

    <div class="chat-window" id="chat-window">
        <div class="chat-header">
            <h3>AI Assistant</h3>
            <button class="chat-close-btn" id="chat-close-btn">&times;</button>
        </div>
        <div class="chat-log" id="chat-log">
            <div class="chat-message bot">
                Hi! I'm your AI assistant. How can I help? You can ask me to "show jobs", "go to marketplace", etc.
            </div>
        </div>
        <div class="chat-input-area">
            <input type="text" id="chat-input" placeholder="Type your message...">
            <button id="chat-send-btn">‚û§</button>
        </div>
    </div>

    <script src="js/intro.js" defer></script>
    <script>
        // --- Simulate database for user details ---
        let userSavedName = '';
        let userSavedPhone = '';

        // --- Simulate database for item passwords ---
        const itemRoomPasswords = {
            'textbook': 'physics101',
            'bicycle': 'ridefast',
        };

        // --- Simulate database for Budget ---
        let budget = {
            expenses: [],
            total: 0,
            totalsByCategory: {
                food: 0,
                school: 0,
                other: 0
            }
        };

        // --- NEW: Simulate database for Daily Challenges ---
        const dailyProblems = {
            tech: [
                "What is the output of this code? \n`console.log(1 + '1');`",
                "Explain the difference between `let`, `const`, and `var` in JavaScript.",
                "What does CSS stand for and what is its primary purpose?"
            ],
            marketing: [
                "What are the 4 P's of Marketing?",
                "Explain the difference between SEO and SEM.",
                "What is a 'target audience' and why is it important?"
            ],
            general: [
                "What is the capital of France?",
                "Who wrote 'Romeo and Juliet'?",
                "What is the chemical formula for water?"
            ]
        };

        // --- Mobile Menu Toggle and Navigation ---
        const menuToggle = document.getElementById('mobile-menu-toggle');
        const navbarMenu = document.getElementById('navbar-menu');
        const navbar = document.querySelector('.navbar');

        // Close menu function
        function closeMenu() {
            menuToggle.classList.remove('is-active');
            navbarMenu.classList.remove('is-active');
            document.body.style.overflow = '';
        }

        // Toggle menu function
        function toggleMenu() {
            const isOpen = menuToggle.classList.contains('is-active');
            menuToggle.classList.toggle('is-active');
            navbarMenu.classList.toggle('is-active');

            // Control body scroll
            if (!isOpen) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = '';
            }
        }

        // Menu toggle click
        menuToggle.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            toggleMenu();
        });

        // Handle menu item clicks
        navbarMenu.addEventListener('click', (e) => {
            if (e.target.tagName === 'A') {
                e.preventDefault();
                const href = e.target.getAttribute('href');
                closeMenu();

                // Navigate after menu closes
                requestAnimationFrame(() => {
                    if (href && href.startsWith('#')) {
                        const targetPage = document.querySelector(href);
                        if (targetPage) {
                            showPage(targetPage);
                        }
                    }
                });
            }
        });

        // Close menu when clicking outside
        document.addEventListener('click', (e) => {
            if (navbarMenu.classList.contains('is-active') &&
                !navbar.contains(e.target)) {
                closeMenu();
            }
        });

        // Handle touch events
        let touchStartY = 0;
        let touchEndY = 0;

        navbarMenu.addEventListener('touchstart', (e) => {
            touchStartY = e.touches[0].clientY;
        }, { passive: true });

        navbarMenu.addEventListener('touchmove', (e) => {
            touchEndY = e.touches[0].clientY;
            const deltaY = touchEndY - touchStartY;

            // If scrolled to top and trying to pull down, prevent default
            if (navbarMenu.scrollTop === 0 && deltaY > 0) {
                e.preventDefault();
            }
        });

        // ===================================
        // --- Page Switching Logic ---
        // ===================================

        // Get Page Containers
        const pageHome = document.getElementById('page-home');
        const pageEvents = document.getElementById('page-events');
        const pageLogin = document.getElementById('page-login');
        const pageProfile = document.getElementById('page-profile');
        const pagePostEvent = document.getElementById('page-post-event');
        const pageMarket = document.getElementById('page-market');
        const pageSellItem = document.getElementById('page-sell-item');
        const pageJobs = document.getElementById('page-jobs');
        const pagePostJob = document.getElementById('page-post-job');
        const pageFeedback = document.getElementById('page-feedback');
        const pageWorkspace = document.getElementById('page-workspace');

        const allPages = [pageHome, pageEvents, pageLogin, pageProfile, pagePostEvent, pageMarket, pageSellItem, pageJobs, pagePostJob, pageFeedback, pageWorkspace];

        // Get Page-Switching Buttons
        const logoHomeLink = document.getElementById('logo-home-link');
        const btnExploreGigs = document.getElementById('btn-explore-gigs');
        const navExploreLink = document.getElementById('nav-explore-link');
        const btnStartEarning = document.getElementById('btn-start-earning');
        const btnJoinNow = document.getElementById('btn-join-now');
        const navLoginLink = document.getElementById('nav-login-link');
        const navProfileLink = document.getElementById('nav-profile-link');
        const postEventButton = document.getElementById('btn-post-event');
        const navMarketLink = document.getElementById('nav-market-link');
        const btnSellItem = document.getElementById('btn-sell-item');
        const navJobsLink = document.getElementById('nav-jobs-link');
        const btnPostJob = document.getElementById('btn-post-job');
        const navFeedbackLink = document.getElementById('nav-feedback-link');
        const navWorkspaceLink = document.getElementById('nav-workspace-link');

        // Page Navigation Functions
        function showPage(pageToShow) {
            allPages.forEach(page => {
                page.style.display = (page === pageToShow) ? 'block' : 'none';
            });
            window.scrollTo(0, 0); // Scroll to top
        }
        function showHomePage(event) { if (event) event.preventDefault(); showPage(pageHome); }
        function showEventsPage(event) { if (event) event.preventDefault(); showPage(pageEvents); }
        function showLoginPage(event) { if (event) event.preventDefault(); showPage(pageLogin); }
        function showProfilePage(event) { if (event) event.preventDefault(); showPage(pageProfile); }
        function showPostEventPage(event) { if (event) event.preventDefault(); showPage(pagePostEvent); }
        function showMarketPage(event) { if (event) event.preventDefault(); showPage(pageMarket); }
        function showSellItemPage(event) { if (event) event.preventDefault(); showPage(pageSellItem); }
        function showJobsPage(event) { if (event) event.preventDefault(); showPage(pageJobs); }
        function showPostJobPage(event) { if (event) event.preventDefault(); showPage(pagePostJob); }
        function showFeedbackPage(event) { if (event) event.preventDefault(); showPage(pageFeedback); }
        function showWorkspacePage(event) { if (event) event.preventDefault(); showPage(pageWorkspace); }

        // Attach Event Listeners
        logoHomeLink.addEventListener('click', showHomePage);
        btnExploreGigs.addEventListener('click', showEventsPage);
        navExploreLink.addEventListener('click', showEventsPage);
        btnStartEarning.addEventListener('click', showLoginPage);
        btnJoinNow.addEventListener('click', showLoginPage);
        navLoginLink.addEventListener('click', showLoginPage);
        navProfileLink.addEventListener('click', showProfilePage);
        postEventButton.addEventListener('click', showPostEventPage);
        navMarketLink.addEventListener('click', showMarketPage);
        btnSellItem.addEventListener('click', showSellItemPage);
        navJobsLink.addEventListener('click', showJobsPage);
        btnPostJob.addEventListener('click', showPostJobPage);
        navFeedbackLink.addEventListener('click', showFeedbackPage);
        navWorkspaceLink.addEventListener('click', showWorkspacePage);

        // ===================================
        // --- Login Tab Logic ---
        // ===================================
        const btnTabUser = document.getElementById('btn-tab-user');
        const btnTabAdmin = document.getElementById('btn-tab-admin');
        const userLoginPanel = document.getElementById('user-login-panel');
        const adminLoginPanel = document.getElementById('admin-login-panel');

        btnTabUser.addEventListener('click', () => {
            btnTabUser.classList.add('active');
            btnTabAdmin.classList.remove('active');
            userLoginPanel.classList.add('active');
            adminLoginPanel.classList.remove('active');
        });

        btnTabAdmin.addEventListener('click', () => {
            btnTabAdmin.classList.add('active');
            btnTabUser.classList.remove('active');
            adminLoginPanel.classList.add('active');
            userLoginPanel.classList.remove('active');
        });

        // ===================================
        // --- User Login/Sign Up Toggle Logic ---
        // ===================================
        const loginToggleLink = document.getElementById('login-toggle-link');
        const loginTitle = document.getElementById('login-title');
        const loginSubtitle = document.getElementById('login-subtitle');
        const loginSubmitBtn = document.getElementById('login-submit-btn');
        const signupNameField = document.getElementById('signup-name-field');
        const loginToggleText = document.getElementById('login-toggle-text');
        let isLoginMode = true;
        loginToggleLink.addEventListener('click', () => {
            isLoginMode = !isLoginMode;
            if (isLoginMode) {
                loginTitle.textContent = 'Login';
                loginSubtitle.textContent = 'Welcome back! Access your account.';
                loginSubmitBtn.textContent = 'Login';
                signupNameField.style.display = 'none';
                loginToggleText.textContent = "Don't have an account?";
                loginToggleLink.textContent = 'Sign Up';
            } else {
                loginTitle.textContent = 'Sign Up';
                loginSubtitle.textContent = 'Create your account to get started.';
                loginSubmitBtn.textContent = 'Create Account';
                signupNameField.style.display = 'block';
                loginToggleText.textContent = 'Already have an account?';
                loginToggleLink.textContent = 'Login';
            }
        });

        // ===================================
        // --- Profile Save Logic ---
        // ===================================
        const btnSaveProfile = document.getElementById('btn-save-profile');
        btnSaveProfile.addEventListener('click', (e) => {
            e.preventDefault();
            userSavedName = document.getElementById('profile-name').value;
            userSavedPhone = document.getElementById('profile-phone').value;

            if (userSavedPhone === '' || userSavedName === '') {
                alert('Please fill out all fields.');
                return;
            }
            alert('Profile Settings Saved!\nName: ' + userSavedName + '\nPhone: ' + userSavedPhone);
            showPage(pageEvents);
        });

        // ===================================
        // --- Post Event & Reward Logic ---
        // ===================================
        const btnSubmitEvent = document.getElementById('btn-submit-event');
        btnSubmitEvent.addEventListener('click', (e) => {
            e.preventDefault();
            if (userSavedPhone === '') {
                alert('Please save your PhonePe number in your Profile settings before posting an event.');
                showPage(pageProfile);
                return;
            }
            const eventTitle = document.getElementById('event-title').value;
            if (eventTitle === '') {
                alert('Please enter an event title.');
                return;
            }
            const minReward = 10;
            const maxReward = 25;
            const rewardAmount = (Math.random() * (maxReward - minReward) + minReward).toFixed(2);
            alert(
                'Event Posted Successfully!\n\n' +
                'Congratulations ' + userSavedName + '! You\'ve won a reward of ‚Çπ' + rewardAmount + '.\n\n' +
                'This will be processed to your saved PhonePe number: ' + userSavedPhone
            );
            document.getElementById('post-event-form').reset();
            showPage(pageEvents);
        });

        // ===================================
        // --- Sell Item Logic ---
        // ===================================
        const btnSubmitItem = document.getElementById('btn-submit-item');
        const marketGrid = document.getElementById('market-grid-container');

        btnSubmitItem.addEventListener('click', (e) => {
            e.preventDefault();

            const title = document.getElementById('item-title').value;
            const desc = document.getElementById('item-desc').value;
            const price = document.getElementById('item-price').value;
            const password = document.getElementById('item-password').value;

            if (!title || !desc || !price || !password) {
                alert('Please fill out all fields.');
                return;
            }

            const itemKey = title.toLowerCase().replace(/\s+/g, '-');
            itemRoomPasswords[itemKey] = password;

            const newCard = document.createElement('div');
            newCard.className = 'market-card';
            newCard.innerHTML = `
                <div class="market-card-image">No Image</div>
                <div class="market-card-content">
                    <h3>${title}</h3>
                    <p class="market-card-desc">${desc}</p>
                    <p class="market-card-price">Starting Bid: ‚Çπ${price}</p>
                    <button class="btn btn-bid" data-item="${itemKey}" data-title="${title}">Bid on Item</button>
                </div>
            `;

            marketGrid.appendChild(newCard);

            document.getElementById('sell-item-form').reset();
            alert('Success! Your item has been posted to the marketplace.');
            showPage(pageMarket);
        });

        // ===================================
        // --- Bidding Logic ---
        // ===================================

        marketGrid.addEventListener('click', (e) => {
            if (e.target.classList.contains('btn-bid')) {

                const itemKey = e.target.dataset.item;
                const itemTitle = e.target.dataset.title;
                const correctPassword = itemRoomPasswords[itemKey];

                if (!correctPassword) {
                    alert('Error: Could not find password for this item.');
                    return;
                }

                const userPassword = prompt(`Enter the room password for "${itemTitle}":`);

                if (userPassword === correctPassword) {
                    const bidAmount = prompt('Password correct! Please enter your bid amount (e.g., 500):');
                    const bidNumber = parseFloat(bidAmount);
                    if (bidNumber > 0) {
                        alert(`Bid Placed!\n\nYour bid of ‚Çπ${bidNumber} for "${itemTitle}" has been recorded.`);
                    } else {
                        alert('Invalid bid. Please enter a valid number.');
                    }
                } else {
                    alert('Incorrect password. Access to bidding room denied.');
                }
            }
        });

        // ===================================
        // --- Post Job Logic ---
        // ===================================
        const btnSubmitJob = document.getElementById('btn-submit-job');
        const jobGrid = document.getElementById('job-grid-container');

        btnSubmitJob.addEventListener('click', (e) => {
            e.preventDefault();

            const title = document.getElementById('job-title').value;
            const company = document.getElementById('job-company').value;
            const type = document.getElementById('job-type').value;
            const location = document.getElementById('job-location').value;
            const skills = document.getElementById('job-skills').value;

            if (!title || !company || !type || !location || !skills) {
                alert('Please fill out all fields.');
                return;
            }

            const newJobCard = document.createElement('div');
            newJobCard.className = 'job-card';
            newJobCard.dataset.type = type.toLowerCase();
            newJobCard.dataset.skills = skills.toLowerCase();

            newJobCard.innerHTML = `
                <div class="job-card-header">
                    <div class="job-card-icon">üíº</div>
                    <div>
                        <h3>${title}</h3>
                        <p class="job-card-company">${company}</p>
                    </div>
                </div>
                <div class="job-card-details">
                    <span class="job-card-tag">${type}</span>
                    <span class="job-card-tag">${location}</span>
                </div>
                <p class="job-card-skills">
                    <strong>Skills:</strong> ${skills}
                </p>
            `;

            jobGrid.appendChild(newJobCard);

            document.getElementById('post-job-form').reset();
            alert('Success! Your job has been posted.');
            showPage(pageJobs);
        });

        // ===================================
        // --- Job Filter Logic ---
        // ===================================
        const filterSkillInput = document.getElementById('filter-skill');
        const filterJobTypeSelect = document.getElementById('filter-job-type');

        function filterJobs() {
            const skillFilter = filterSkillInput.value.toLowerCase();
            const typeFilter = filterJobTypeSelect.value;
            const allJobCards = jobGrid.querySelectorAll('.job-card');

            allJobCards.forEach(card => {
                const skills = card.dataset.skills;
                const type = card.dataset.type;
                const skillMatch = skills.includes(skillFilter);
                const typeMatch = (typeFilter === 'all') || (type === typeFilter);

                if (skillMatch && typeMatch) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        filterSkillInput.addEventListener('keyup', filterJobs);
        filterJobTypeSelect.addEventListener('change', filterJobs);

        // ===================================
        // --- To-Do List Logic ---
        // ===================================
        const todoForm = document.getElementById('todo-input-form');
        const todoInput = document.getElementById('todo-input');
        const todoList = document.getElementById('todo-list');

        todoForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const taskText = todoInput.value.trim();
            if (taskText === '') return;

            const li = document.createElement('li');
            li.innerHTML = `
                <span>${taskText}</span>
                <button class="todo-remove-btn">‚úñ</button>
            `;

            todoList.appendChild(li);
            todoInput.value = '';
        });

        // Event listener for deleting tasks
        todoList.addEventListener('click', (e) => {
            if (e.target.classList.contains('todo-remove-btn')) {
                e.target.parentElement.remove();
            }
        });

        // ===================================
        // --- Budget Tracker Logic ---
        // ===================================
        const budgetForm = document.getElementById('budget-add-form');
        const budgetDescInput = document.getElementById('budget-desc');
        const budgetAmountInput = document.getElementById('budget-amount');
        const budgetCategorySelect = document.getElementById('budget-category');
        const budgetTotalEl = document.getElementById('budget-total');
        const budgetList = document.getElementById('budget-list');

        budgetForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const desc = budgetDescInput.value;
            const amount = parseFloat(budgetAmountInput.value);
            const category = budgetCategorySelect.value;

            if (!desc || isNaN(amount) || amount <= 0) {
                alert('Please enter a valid description and amount.');
                return;
            }

            const expense = { desc, amount, category };
            budget.expenses.push(expense);
            budget.total += amount;
            budget.totalsByCategory[category] += amount;

            renderBudget();

            budgetDescInput.value = '';
            budgetAmountInput.value = '';
        });

        function renderBudget() {
            budgetTotalEl.textContent = `Total: ‚Çπ${budget.total.toFixed(2)}`;
            budgetList.innerHTML = '';
            budget.expenses.forEach(expense => {
                const li = document.createElement('li');
                li.className = 'expense-item';
                li.innerHTML = `
                    <span>${expense.desc} (${expense.category})</span>
                    <span>‚Çπ${expense.amount.toFixed(2)}</span>
                `;
                budgetList.appendChild(li);
            });
            renderBudgetVisualization();
        }

        function renderBudgetVisualization() {
            const total = budget.total;
            if (total === 0) {
                // Reset bars if total is zero
                document.getElementById('food-bar').style.width = '0%';
                document.getElementById('school-bar').style.width = '0%';
                document.getElementById('other-bar').style.width = '0%';
                document.getElementById('food-percent').textContent = '0%';
                document.getElementById('school-percent').textContent = '0%';
                document.getElementById('other-percent').textContent = '0%';
                return;
            };

            const foodPercent = (budget.totalsByCategory.food / total) * 100;
            const schoolPercent = (budget.totalsByCategory.school / total) * 100;
            const otherPercent = (budget.totalsByCategory.other / total) * 100;

            document.getElementById('food-bar').style.width = `${foodPercent.toFixed(0)}%`;
            document.getElementById('school-bar').style.width = `${schoolPercent.toFixed(0)}%`;
            document.getElementById('other-bar').style.width = `${otherPercent.toFixed(0)}%`;

            document.getElementById('food-percent').textContent = `${foodPercent.toFixed(0)}%`;
            document.getElementById('school-percent').textContent = `${schoolPercent.toFixed(0)}%`;
            document.getElementById('other-percent').textContent = `${otherPercent.toFixed(0)}%`;
        }

        // ===================================
        // --- NEW: Daily Challenge Logic ---
        // ===================================
        const challengeSelect = document.getElementById('challenge-topic-select');
        const challengeBtn = document.getElementById('new-challenge-btn');
        const challengeProblemArea = document.getElementById('challenge-problem-area');

        challengeBtn.addEventListener('click', () => {
            const topic = challengeSelect.value;
            const problems = dailyProblems[topic];
            const randomIndex = Math.floor(Math.random() * problems.length);
            const problem = problems[randomIndex];

            // Format the problem text to respect newlines
            challengeProblemArea.innerHTML = problem.replace(/\n/g, '<br>');
        });


        // ===================================
        // --- Voice Assistant Logic ---
        // ===================================

        const voiceAssistBtn = document.getElementById('voice-assist-btn');
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

        if (SpeechRecognition) {
            const recognition = new SpeechRecognition();
            recognition.lang = 'en-US';

            voiceAssistBtn.addEventListener('click', () => {
                if (voiceAssistBtn.classList.contains('is-listening')) {
                    recognition.stop();
                } else {
                    recognition.start();
                }
            });

            recognition.onstart = () => {
                voiceAssistBtn.classList.add('is-listening');
                voiceAssistBtn.innerHTML = '...';
            };

            recognition.onresult = (event) => {
                const command = event.results[0][0].transcript.toLowerCase();
                handleVoiceCommand(command);
            };

            recognition.onend = () => {
                voiceAssistBtn.classList.remove('is-listening');
                voiceAssistBtn.innerHTML = 'üé§';
            };

            recognition.onerror = (event) => {
                console.error('Voice recognition error:', event.error);
                alert('Voice error: ' + event.error);
                voiceAssistBtn.classList.remove('is-listening');
                voiceAssistBtn.innerHTML = 'üé§';
            };

        } else {
            alert('Your browser does not support voice recognition.');
            voiceAssistBtn.style.display = 'none';
        }

        function handleVoiceCommand(command) {
            if (command.includes('workspace')) {
                showPage(pageWorkspace);
            } else if (command.includes('feedback') || command.includes('contact')) {
                showPage(pageFeedback);
            } else if (command.includes('home') || command.includes('main page')) {
                showPage(pageHome);
            } else if (command.includes('events') || command.includes('explore')) {
                showPage(pageEvents);
            } else if (command.includes('jobs') || command.includes('internships')) {
                showPage(pageJobs);
            } else if (command.includes('market') || command.includes('marketplace') || command.includes('buy')) {
                showPage(pageMarket);
            } else if (command.includes('sell') || command.includes('sell item')) {
                showPage(pageSellItem);
            } else if (command.includes('profile') || command.includes('settings')) {
                showPage(pageProfile);
            } else if (command.includes('login') || command.includes('sign in') || command.includes('log in')) {
                showPage(pageLogin);
            } else if (command.includes('post') || command.includes('post event')) {
                showPage(pagePostEvent);
            } else {
                const utterance = new SpeechSynthesisUtterance("Sorry, I didn't understand the command: " + command);
                speechSynthesis.speak(utterance);
            }
        }

        // ===================================
        // --- Global Chatbot Logic ---
        // ===================================

        const chatWindow = document.getElementById('chat-window');
        const chatToggleBtn = document.getElementById('chat-toggle-btn');
        const chatCloseBtn = document.getElementById('chat-close-btn');
        const chatSendBtn = document.getElementById('chat-send-btn');
        const chatInput = document.getElementById('chat-input');
        const chatLog = document.getElementById('chat-log');

        chatToggleBtn.addEventListener('click', () => {
            chatWindow.classList.toggle('is-open');
        });

        chatCloseBtn.addEventListener('click', () => {
            chatWindow.classList.remove('is-open');
        });

        chatSendBtn.addEventListener('click', sendGlobalMessage);
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendGlobalMessage();
            }
        });

        function sendGlobalMessage() {
            const messageText = chatInput.value.trim();
            if (messageText === '') return;

            addMessageToLog(messageText, 'user', chatLog);
            chatInput.value = '';

            const botReply = getBotResponse(messageText);
            if (botReply) {
                addMessageToLog(botReply, 'bot', chatLog);
            }
        }

        // --- Universal function for adding messages ---
        function addMessageToLog(text, sender, logElement) {
            const messageElement = document.createElement('div');
            messageElement.className = `chat-message ${sender}`;
            messageElement.innerHTML = text.replace(/\n/g, '<br>'); // Respect newlines
            logElement.appendChild(messageElement);
            logElement.scrollTop = logElement.scrollHeight;
        }

        // Simple rule-based chatbot (offline, no Gemini)
        function getBotResponse(message) {
            if (!message) return '';
            const text = message.toLowerCase();

            if (text.includes('hello') || text.includes('hi') || text.includes('hey')) {
                return 'Hi there! I\'m your Campus Hub assistant. How can I help you today?';
            }

            if (text.includes('event')) {
                return 'You can view events on the Events page and post your own events after logging in. Use the navigation bar and choose "Events".';
            }

            if (text.includes('job') || text.includes('intern')) {
                return 'Check the Jobs page to see jobs and internships. You can also post opportunities for other students.';
            }

            if (text.includes('market') || text.includes('buy') || text.includes('sell')) {
                return 'The Marketplace page lets you buy and sell items with other students. Open "Marketplace" from the top menu.';
            }

            if (text.includes('workspace') || text.includes('budget') || text.includes('todo')) {
                return 'The Personal Workspace has a budget tracker, to-do list, and embedded chat. Open "My Workspace" from the navigation bar.';
            }

            if (text.includes('feedback') || text.includes('contact')) {
                return 'To send feedback, go to the Feedback section, fill in your details, and submit the form. Your message will be sent directly.';
            }

            if (text.includes('login') || text.includes('sign up') || text.includes('signup')) {
                return 'Use the Login / Signup page to create an account or sign in. Once logged in, you can post events, jobs, and marketplace items.';
            }

            return 'I\'m not sure about that yet, but you can explore the Events, Jobs, Marketplace, Workspace, and Feedback sections using the navigation bar.';
        }

        // ===================================
        // --- Workspace Chat Logic ---
        // ===================================

        const wsChatSendBtn = document.getElementById('workspace-chat-send-btn');
        const wsChatInput = document.getElementById('workspace-chat-input');
        const wsChatLog = document.getElementById('workspace-chat-log');

        wsChatSendBtn.addEventListener('click', sendWorkspaceMessage);
        wsChatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendWorkspaceMessage();
            }
        });

        // ===================================
        // --- Telegram Bot Button Logic ---
        // ===================================

        const telegramBotBtn = document.getElementById('telegram-bot-btn');
        if (telegramBotBtn) {
            telegramBotBtn.addEventListener('click', () => {
                window.open('https://t.me/stud030bot', '_blank');
            });
        }

        async function sendWorkspaceMessage() {
            const messageText = wsChatInput.value.trim();
            if (messageText === '') return;

            addMessageToLog(messageText, 'user', wsChatLog);
            wsChatInput.value = '';
            wsChatSendBtn.disabled = true;
            wsChatSendBtn.textContent = 'Thinking...';

            try {
                // Use Puter.js AI for intelligent responses
                const systemPrompt = 'You are the AI assistant for Campus Hub, a web app for college students. ' +
                    'Campus Hub helps with: events, jobs & internships, marketplace (buy/sell items), personal workspace (budget tracker + todo + chat), and feedback/contact. ' +
                    'Answer conversationally and clearly. If you do not know something, say you are not sure instead of making it up.';

                const response = await puter.ai.chat(systemPrompt + '\n\nUser: ' + messageText);
                addMessageToLog(response, 'bot', wsChatLog);
            } catch (error) {
                console.error('Puter.js AI error:', error);
                // Fallback to simple bot response
                const botReply = getBotResponse(messageText);
                if (botReply) {
                    addMessageToLog(botReply, 'bot', wsChatLog);
                } else {
                    addMessageToLog('Sorry, I\'m having trouble connecting to AI services right now. Please try again later.', 'bot', wsChatLog);
                }
            } finally {
                wsChatSendBtn.disabled = false;
                wsChatSendBtn.textContent = 'Send';
            }
        }

        // ===================================
        // --- EmailJS Feedback Logic ---
        // ===================================

        // Initialize EmailJS with your Public Key (EmailJS dashboard -> Account -> API Keys)
        emailjs.init('_oNb1898SjS6iMNi_');

        const feedbackForm = document.getElementById('feedback-form');
        const sendFeedbackBtn = document.getElementById('btn-send-feedback');

        feedbackForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            sendFeedbackBtn.disabled = true;
            sendFeedbackBtn.textContent = 'Sending...';

            const name = document.getElementById('feedback-name').value.trim();
            const email = document.getElementById('feedback-email').value.trim();
            const message = document.getElementById('feedback-message').value.trim();

            // Send via EmailJS only (configured to your Gmail in EmailJS dashboard)
            try {
                await emailjs.sendForm('service_uhqzwb2', 'template_k4h48xg', feedbackForm);
                alert('Feedback sent! Thank you.');
            } catch (emailErr) {
                console.error('EmailJS Error (expected if not configured):', emailErr);
                alert('Could not send feedback via EmailJS. Please configure your EmailJS service, template, and public key.');
            } finally {
                feedbackForm.reset();
                sendFeedbackBtn.disabled = false;
                sendFeedbackBtn.textContent = 'Send Feedback';
                showPage(pageHome);
            }
        });

    </script>
    <script>
        window.onerror = function (message, source, lineno, colno, error) {
            console.error('Unhandled error:', message, 'at', source, 'line', lineno, 'col', colno, error);
        };
    </script>
</body>

</html>